import javax.swing.*;
import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.util.ArrayList;
import java.util.Date;
import java.text.SimpleDateFormat;

public class GorevEkleme extends Gorev {

    public  boolean isDecimal(String input)
    {
        //virgul ıcerıp ıcermedıgını kontrol edıyo.
        return (input.contains(",")||input.contains("."));
    }

    ArrayList<String>gorevlist=new ArrayList<>();
    //JPanel altpanel;
    JPanel genelpanel;
    JFrame frame;
    JLabel TOPLAMGOREVSAYISI=new JLabel();
    public GorevEkleme(JPanel genelpanel, JFrame frame,JLabel TOPLAMGOREVSAYISI) {
        this.genelpanel = genelpanel;
        this.frame=frame;
        this.TOPLAMGOREVSAYISI=TOPLAMGOREVSAYISI;
        genelpanel.setLayout(new GridLayout(15,1));
    }
    //private olabılır
    private final int []y5={0};
    public void altpanelfonk() {
        JPanel altpanel;
        altpanel = new JPanel();
        altpanel.setLayout(new BoxLayout(altpanel, BoxLayout.X_AXIS));
        altpanel.setBounds(0, y5[0], 800, 50);
        y5[0] += 50;

        JOptionPane gorevekleme = new JOptionPane();
        //private olabılır
        //hocam bir methodun icicdeki degiskenler yerel olur ve yereller private olamaz.
        setGorevtext(JOptionPane.showInputDialog(gorevekleme, "Gorev giriniz:", "Gorev Ekleme", JOptionPane.INFORMATION_MESSAGE));
        frame.add(gorevekleme);
        frame.revalidate();
        frame.repaint();

        //private olabılır

        int oncelikdeger = 0;
        try {
            JOptionPane oncelikalma = new JOptionPane();
            setOncelik(JOptionPane.showInputDialog(oncelikalma, "Gorevin oncelik numarasini giriniz (1-5)", "ONCELIK", JOptionPane.PLAIN_MESSAGE));
            oncelikdeger = Integer.parseInt(getOncelik());
            if (oncelikdeger > 5 || oncelikdeger < 1) {
                throw new OncelikException();

            }
            frame.add(oncelikalma);
            frame.revalidate();
            frame.repaint();
        } catch (OncelikException e) {
            System.out.println(e.getMessage());
            setOncelik("Hata");

            while(oncelikdeger>5 || oncelikdeger<1)
            {
                JOptionPane oncelikhatasi = new JOptionPane();
                JOptionPane.showMessageDialog(oncelikhatasi, "Oncelik numarasi 1 ile 5 arasinda olmalidir.", "Oncelik Hatasi", JOptionPane.ERROR_MESSAGE);
                frame.add(oncelikhatasi);
                JOptionPane oncelikalma = new JOptionPane();
                setOncelik(JOptionPane.showInputDialog(oncelikalma, "Gorevin oncelik numarasini giriniz (1-5)", "ONCELIK", JOptionPane.PLAIN_MESSAGE));
                oncelikdeger = Integer.parseInt(getOncelik());

            }




        }
        catch(NumberFormatException e)
        {
            System.out.println("Oncelik no virgullu girilemez!!");
            do {

               try {
                   JOptionPane oncelikhatasi2 = new JOptionPane();
                   JOptionPane.showMessageDialog(oncelikhatasi2, "Oncelik numarasi virgullu olamaz!!.", "Oncelik Hatasi", JOptionPane.ERROR_MESSAGE);
                   frame.add(oncelikhatasi2);
                   JOptionPane oncelikalma2 = new JOptionPane();
                   setOncelik(JOptionPane.showInputDialog(oncelikalma2, "Gorevin oncelik numarasini giriniz (1-5)", "ONCELIK", JOptionPane.PLAIN_MESSAGE));
                   frame.add(oncelikalma2);

                   oncelikdeger = Integer.parseInt(getOncelik());
               }
               catch (NumberFormatException E)
               {
                   if((!isDecimal(getOncelik())) && (oncelikdeger<1 || oncelikdeger>5))
                   {
                       while(oncelikdeger>5 || oncelikdeger<1)
                       {

                           JOptionPane oncelikhatasi = new JOptionPane();
                           JOptionPane.showMessageDialog(oncelikhatasi, "Oncelik numarasi 1 ile 5 arasinda olmalidir.", "Oncelik Hatasi", JOptionPane.ERROR_MESSAGE);
                           frame.add(oncelikhatasi);
                           JOptionPane oncelikalma = new JOptionPane();
                           setOncelik(JOptionPane.showInputDialog(oncelikalma, "Gorevin oncelik numarasini giriniz (1-5)", "ONCELIK", JOptionPane.PLAIN_MESSAGE));
                           oncelikdeger = Integer.parseInt(getOncelik());

                       }




                   }
               }

                if((!isDecimal(getOncelik())) && (oncelikdeger<1 || oncelikdeger>5))
                {
                    while(oncelikdeger>5 || oncelikdeger<1)
                    {

                        JOptionPane oncelikhatasi = new JOptionPane();
                        JOptionPane.showMessageDialog(oncelikhatasi, "Oncelik numarasi 1 ile 5 arasinda olmalidir.", "Oncelik Hatasi", JOptionPane.ERROR_MESSAGE);
                        frame.add(oncelikhatasi);
                        JOptionPane oncelikalma = new JOptionPane();
                        setOncelik(JOptionPane.showInputDialog(oncelikalma, "Gorevin oncelik numarasini giriniz (1-5)", "ONCELIK", JOptionPane.PLAIN_MESSAGE));
                        oncelikdeger = Integer.parseInt(getOncelik());

                    }




                }
            }
            while(isDecimal(getOncelik()));

        }
       // catch()
        finally {
            //programın devam etmesını saglıyor.
            frame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
        }


        JCheckBox c1 = new JCheckBox();
        altpanel.add(c1, 0);

        genelpanel.revalidate();
        genelpanel.repaint();


        JTextField gorev = new JTextField();
        gorev.setText(getGorevtext());
        gorev.setFont(new Font("Monospaced", Font.BOLD, 15));
        altpanel.add(gorev);
        gorev.setMaximumSize(new Dimension(400, 90));
        gorev.setBackground(Color.lightGray);
        genelpanel.revalidate();
        genelpanel.repaint();



        gorevlist.add(getGorevtext());
        TOPLAMGOREVSAYISI.setText("Toplam gorev sayisi: "+gorevlist.size());


        Date tarih = new Date();
        SimpleDateFormat tarihFormatter = new SimpleDateFormat("dd/MM/yyyy");

        setTarih(tarihFormatter.format(tarih));
        JLabel tarihLabel = new JLabel(getTarih());
        tarihLabel.setFont(new Font("Monospaced", Font.BOLD, 15));
        altpanel.add(tarihLabel);
        tarihLabel.setMaximumSize(new Dimension(180, 50));
        genelpanel.revalidate();
        genelpanel.repaint();



        SimpleDateFormat saatFormatter=new SimpleDateFormat("HH:mm");
        setSaat(saatFormatter.format(tarih));
        JLabel saatLabel = new JLabel(getSaat());
        saatLabel.setFont(new Font("Monospaced", Font.BOLD, 15));
        altpanel.add(saatLabel);
        saatLabel.setMaximumSize(new Dimension(100, 50));
        genelpanel.revalidate();
        genelpanel.repaint();

        //ıcı yazılacak
        JLabel onceliklabel = new JLabel();
        onceliklabel.setText(getOncelik());
        onceliklabel.setFont(new Font("Monospaced", Font.BOLD, 15));
        onceliklabel.setMaximumSize(new Dimension(50, 50));
        altpanel.add(onceliklabel);
        genelpanel.revalidate();
        genelpanel.repaint();

        JButton carpi = new JButton();
        carpi.setFont(new Font("Monospaced", Font.BOLD, 15));
        carpi.setText("X");
        altpanel.add(carpi);
        carpi.setBackground(Color.red);
        genelpanel.revalidate();
        genelpanel.repaint();

        carpi.addActionListener(new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent e) {
                genelpanel.remove(altpanel);
                genelpanel.revalidate();

                genelpanel.repaint();


            }

        });



        genelpanel.add(altpanel);


    }

   /* @Override
    public void actionPerformed(ActionEvent e) {
        genelpanel.remove(altpanel);
        genelpanel.revalidate();
        genelpanel.repaint();
    }*/


}
